/**
 * modern-modal-fixes.css - Solution unifiée pour tous les modaux de l'application
 * v2.0.0 - Optimisé et consolidé pour fixer les problèmes de scintillement
 */

/* ===== STYLES DE BASE POUR LES MODAUX PORTAL ===== */
/* Structure de base de l'environnement du portal */
#portal-modal-container {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%; 
    z-index: 99999;
    pointer-events: none;
}

/* Backdrop du portal (fond semi-transparent) */
#portal-modal-container .portal-backdrop {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    background-color: rgba(0, 0, 0, 0.5);
    z-index: 999999;
    pointer-events: auto;
}

/* Modal en lui-même */
#portal-modal-container .portal-modal {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: auto;
    max-width: 90vw;
    max-height: 90vh;
    background-color: white;
    border-radius: 6px;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
    z-index: 1000000;
    pointer-events: auto;
    overflow: auto;
}

/* Contenu du modal */
#portal-modal-container .modal-content {
    border: none;
    border-radius: 0.5rem;
    box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.5);
    background-color: #fff;
}

/* En-têtes des modaux */
#portal-modal-container .modal-header {
    position: relative;
    z-index: auto;
    border-bottom: 1px solid #dee2e6;
    padding: 1rem 1rem;
}

/* Corps des modaux */
#portal-modal-container .modal-body {
    position: relative;
    z-index: auto;
    padding: 1rem;
}

/* Pieds des modaux */
#portal-modal-container .modal-footer {
    position: relative;
    z-index: auto;
    border-top: 1px solid #dee2e6;
    padding: 0.75rem;
}

/* ===== FIXES POUR LES CONTRÔLES DE FORMULAIRE ===== */
/* Correction critique pour les selects */
#portal-modal-container select,
#portal-modal-container .form-select {
    display: block !important;
    visibility: visible !important;
    opacity: 1 !important;
    z-index: 1056 !important;
    position: relative !important;
    pointer-events: auto !important;
    -webkit-appearance: listbox !important;
    appearance: listbox !important;
    width: 100% !important;
}

/* Correction pour les inputs */
#portal-modal-container input:not([type="hidden"]),
#portal-modal-container textarea,
#portal-modal-container .form-control {
    display: block !important;
    visibility: visible !important;
    opacity: 1 !important;
    position: relative !important;
    z-index: 1055 !important;
    pointer-events: auto !important;
    width: 100% !important;
}

/* Correction pour les boutons */
#portal-modal-container button:not(.btn-close),
#portal-modal-container .btn:not(.btn-close) {
    position: relative !important;
    z-index: 1057 !important; 
    pointer-events: auto !important;
    opacity: 1 !important;
    visibility: visible !important;
}

/* Bouton de fermeture spécifique */
#portal-modal-container .btn-close,
#portal-modal-container [data-portal-dismiss="modal"] {
    position: relative !important;
    z-index: 1060 !important;
    pointer-events: auto !important;
    opacity: 1 !important;
    visibility: visible !important;
}

/* ===== STYLES SPÉCIFIQUES POUR LES THÈMES ===== */
/* Badges de thème dans les modaux */
#portal-modal-container .theme-badge {
    position: relative !important;
    z-index: 5 !important;
    display: inline-flex !important;
    align-items: center !important;
    visibility: visible !important;
    opacity: 1 !important;
}

/* ===== AJUSTEMENTS POUR LES APPAREILS MOBILES ===== */
@media (max-width: 576px) {
    #portal-modal-container .portal-modal {
        width: 90% !important;
        max-height: 80vh !important;
    }
    
    #portal-modal-container input,
    #portal-modal-container select,
    #portal-modal-container textarea {
        font-size: 16px !important; /* Empêcher le zoom sur iOS */
    }
}

/* ===== ANIMATIONS LISSES ===== */
/* Animation d'entrée du backdrop */
@keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
}

/* Animation d'entrée du modal */
@keyframes slideIn {
    from { 
        opacity: 0;
        transform: translate(-50%, -60%);
    }
    to { 
        opacity: 1;
        transform: translate(-50%, -50%);
    }
}

/* Application des animations */
#portal-modal-container .portal-backdrop {
    animation: fadeIn 0.15s ease-out forwards;
}

#portal-modal-container .portal-modal {
    animation: slideIn 0.2s ease-out forwards;
}

/* Suppression des transitions conflictuelles */
#portal-modal-container *,
#portal-modal-container *::before,
#portal-modal-container *::after {
    transition-property: none !important;
}